<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:widget="http://www.netvibes.com/ns/">
<head>

<title>Image box</title>

<meta name="author" content="Author name" />
<meta name="version" content="0.0.1" />

<widget:preferences>
  <preference name="src" type="image" label="Image file" defaultValue="" />
  <preference name="alt" type="text" label="Alternate text" defaultValue="" />
  <preference name="width" type="text" label="Width" defaultValue="" />
  <preference name="height" type="text" label="Height" defaultValue="" />
  <preference name="link" type="text" label="Link" defaultValue="" />
  <preference name="caption" type="text" label="Caption" defaultValue="" />
</widget:preferences>

<script type="text/javascript">
var ImageBox = {}

ImageBox.display = function() {
  var img = widget.createElement('img');
  var src = widget.getValue('src');
  var width = widget.getValue('width');
  var alt = widget.getValue('alt');
  var height = widget.getValue('height');
  var link = widget.getValue('link');
  var caption = widget.getValue('caption');
    
  if (src) {
    img.src = NXThemesWebWidgets.getWidgetDataUrl(src);
    if (width) {
      img.width = width;
    }
    if (height) {
      img.height = height;
    }
    img.alt = alt;
    
    if (link) {
      img.setStyle({'border': 'none'});
      var a = widget.createElement('a');
      a.href = link;
      a.appendChild(img);
      widget.setBody(a);
    } else {
      widget.setBody(img);
    }
    
    if (caption) {
      widget.addBody('<div><small>' + caption + '</small></div>');
    }
    
  } else {
    widget.setBody('<p>Please set the image source.</p>');
  }
}

widget.onLoad = function() {
  ImageBox.display();
}

widget.onRefresh = widget.onLoad;

</script>

</head>
<body>
</body>
</html>
