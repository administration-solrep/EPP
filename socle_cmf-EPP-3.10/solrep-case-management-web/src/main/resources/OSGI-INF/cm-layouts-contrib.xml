<?xml version="1.0" encoding="UTF-8"?>
<component name="com.nuxeo.case-management.layouts">
  <require>fr.dila.ecm.platform.routing.layouts.webapp</require>
  <extension target="org.nuxeo.ecm.platform.forms.layout.WebLayoutManager"
    point="widgettypes">
    <widgetType name="summary_current_case">
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/summary/summary_current_case_template.xhtml
      </property>
    </widgetType>
    <widgetType name="summary_case_item_content">
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/summary/summary_caseitem_content_widget_template.xhtml
      </property>
    </widgetType>
  </extension>

  <extension target="org.nuxeo.ecm.platform.forms.layout.WebLayoutManager"
    point="widgets">
    <widget name="summary_current_case" type="summary_current_case" />
    <widget name="summary_case_item_content" type="summary_case_item_content" />

    <widget name="mailbox_id" type="text">
      <labels>
        <label mode="any">label.mailbox.id</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>mlbx:mailbox_id</field>
      </fields>
      <widgetModes>
        <mode value="create">hidden</mode>
        <mode value="any">view</mode>
      </widgetModes>
      <properties widgetMode="edit">
        <property name="validator">
          #{cmMailboxActions.validateMailboxId}
        </property>
        <property name="required">true</property>
        <property name="styleClass">dataInputText</property>
      </properties>
    </widget>

    <widget name="title" type="text">
      <labels>
        <label mode="any">title</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>dc:title</field>
      </fields>
      <properties widgetMode="edit">
        <property name="required">true</property>
        <property name="styleClass">dataInputText</property>
      </properties>
    </widget>

    <widget name="description" type="textarea">
      <labels>
        <label mode="any">description</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>dc:description</field>
      </fields>
      <properties widgetMode="edit">
        <property name="styleClass">dataInputText</property>
      </properties>
    </widget>

    <widget name="mailbox_type" type="template">
      <labels>
        <label mode="any">label.mailbox.type</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>mlbx:type</field>
      </fields>
      <!-- do not change type after creation -->
      <widgetModes>
        <mode value="create">edit</mode>
        <mode value="any">view</mode>
      </widgetModes>
      <properties mode="any">
        <property name="template">
          /casemanagement_widgets/mailbox_type_widget_template.xhtml
        </property>
      </properties>
      <properties widgetMode="edit">
        <property name="required">true</property>
        <property name="styleClass">dataInputText</property>
      </properties>
    </widget>

    <widget name="mailbox_profiles" type="selectManyDirectory">
      <fields>
        <field>mlbx:profiles</field>
      </fields>
      <labels>
        <label mode="any">label.casemanagement.document.profiles</label>
      </labels>
      <translated>true</translated>
      <properties widgetMode="any">
        <!-- TODO: restrict values according to current user accreditation -->
        <property name="directoryName">cm_mailbox_profile</property>
        <property name="localize">true</property>
      </properties>
      <properties widgetMode="edit">
        <property name="notDisplayDefaultOption">true</property>
        <property name="ordering">label</property>
      </properties>
    </widget>

    <widget name="mailbox_affiliation" type="template">
      <labels>
        <label mode="any">label.mailbox.affiliatedMailbox</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>mlbx:affiliated_mailbox_id</field>
      </fields>
      <properties mode="any">
        <property name="template">
          /casemanagement_widgets/single_mailbox_suggestion_widget_template.xhtml
        </property>
      </properties>
      <properties mode="edit">
        <property name="mailboxSuggestionSearchType">generic</property>
      </properties>
    </widget>

    <widget name="mailbox_parent" type="template">
      <labels>
        <label mode="any">label.casemanagement.parentMailbox</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field></field>
      </fields>
      <!-- do not change parent after creation -->
      <widgetModes>
        <mode value="create">edit</mode>
        <mode value="any">view</mode>
      </widgetModes>
      <properties mode="any">
        <property name="template">
          /casemanagement_widgets/parent_mailbox_suggestion_widget_template.xhtml
        </property>
      </properties>
    </widget>

    <widget name="mailbox_owner" type="template">
      <fields>
        <field>mlbx:owner</field>
      </fields>
      <labels>
        <label mode="any">label.mailbox.owner</label>
      </labels>
      <translated>true</translated>
      <!-- do not change a personal mailbox owner -->
      <widgetModes>
        <mode value="create">edit</mode>
        <mode value="edit">
          #{nxu:test(layoutValue.mlbx.type=='personal',
          'view', 'edit')}
        </mode>
      </widgetModes>
      <properties mode="any">
        <property name="template">
          /widgets/single_user_suggestion_widget_template.xhtml
        </property>
      </properties>
      <properties widgetMode="edit">
        <property name="required">true</property>
        <property name="userSuggestionSearchType">USER_TYPE</property>
      </properties>
    </widget>

    <!-- XXX: depends on mailbox_owner and mailbox_type widget names: throws 
      an error when trying to create a personal mailbox for a user who already 
      has one -->
    <widget name="mailbox_validate_personal_owner" type="template">
      <labels>
        <label mode="any"></label>
      </labels>
      <translated>true</translated>
      <widgetModes>
        <mode value="create">edit</mode>
        <mode value="any">hidden</mode>
      </widgetModes>
      <properties widgetMode="edit">
        <property name="template">
          /casemanagement_widgets/mailbox_personal_owner_validation_widget_template.xhtml
        </property>
      </properties>
    </widget>

    <widget name="mailbox_users" type="template">
      <fields>
        <field>mlbx:users</field>
      </fields>
      <labels>
        <label mode="any">label.mailbox.users</label>
      </labels>
      <translated>true</translated>
      <properties mode="any">
        <property name="template">
          /widgets/user_suggestion_widget_template.xhtml
        </property>
      </properties>
      <properties widgetMode="edit">
        <property name="userSuggestionSearchType">USER_TYPE</property>
      </properties>
    </widget>

    <widget name="mailbox_groups" type="template">
      <fields>
        <field>mlbx:groups</field>
      </fields>
      <labels>
        <label mode="any">label.mailbox.groups</label>
      </labels>
      <translated>true</translated>
      <properties mode="any">
        <property name="template">
          /widgets/user_suggestion_widget_template.xhtml
        </property>
      </properties>
      <properties widgetMode="edit">
        <property name="userSuggestionSearchType">GROUP_TYPE</property>
      </properties>
    </widget>

    <widget name="mailbox_lastSyncUpdate" type="text">
      <widgetModes>
        <mode value="any">view</mode>
        <mode value="create">hidden</mode>
      </widgetModes>
      <labels>
        <label mode="any">label.mailbox.synchronizer.lastSyncUpdate
        </label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>mlbx:lastSyncUpdate</field>
      </fields>
    </widget>

    <widget name="mailbox_sync_id" type="text">
      <widgetModes>
        <mode value="any">view</mode>
        <mode value="create">hidden</mode>
      </widgetModes>
      <labels>
        <label mode="any">label.mailbox.synchronizer.id</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>mlbx:synchronizerId</field>
      </fields>
    </widget>

    <widget name="mailbox_origin" type="text">
      <widgetModes>
        <mode value="any">view</mode>
        <mode value="create">hidden</mode>
      </widgetModes>
      <labels>
        <label mode="any">label.mailbox.origin</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>mlbx:origin</field>
      </fields>
    </widget>


    <widget name="mailbox_sync_state" type="selectOneDirectory">
      <fields>
        <field>mlbx:synchronizedState</field>
      </fields>
      <labels>
        <label mode="any">label.mailbox.synchronizer.state</label>
      </labels>
      <translated>true</translated>
      <properties widgetMode="any">
        <property name="directoryName">cm_mailbox_sync_state</property>
        <property name="localize">true</property>
      </properties>
      <properties widgetMode="edit">
        <property name="notDisplayDefaultOption">true</property>
        <property name="ordering">label</property>
      </properties>
    </widget>

    <widget name="action_participants" type="template">
      <labels>
        <label mode="any">label.casemanagement.distribution.actionParticipants
        </label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>forActionMailboxes</field>
      </fields>
      <properties mode="any">
        <property name="template">
          /casemanagement_widgets/mailbox_suggestion_widget_template.xhtml
        </property>
      </properties>
    </widget>

    <widget name="copy_participants" type="template">
      <labels>
        <label mode="any">label.distribution.copyParticipants</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>forInformationMailboxes</field>
      </fields>
      <properties mode="any">
        <property name="template">
          /casemanagement_widgets/mailbox_suggestion_widget_template.xhtml
        </property>
      </properties>
    </widget>

    <widget name="distribution_comment" type="textarea">
      <fields>
        <field>comment</field>
      </fields>
      <labels>
        <label mode="any">label.relation.comment</label>
      </labels>
      <translated>true</translated>
      <properties widgetMode="edit">
        <property name="cssStyleClass">dataInputText</property>
      </properties>
    </widget>

  </extension>

  <extension target="org.nuxeo.ecm.platform.forms.layout.WebLayoutManager"
    point="layouts">

    <layout name="cm_mailbox">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <widget>mailbox_id</widget>
        </row>
        <row>
          <widget>title</widget>
        </row>
        <row>
          <widget>description</widget>
        </row>
        <row>
          <widget>mailbox_type</widget>
        </row>
        <row>
          <widget>mailbox_owner</widget>
        </row>
        <row>
          <widget>mailbox_validate_personal_owner</widget>
        </row>
        <row>
          <widget>mailbox_profiles</widget>
        </row>
        <row>
          <widget>mailbox_parent</widget>
        </row>
        <row>
          <widget>mailbox_affiliation</widget>
        </row>
        <row>
          <widget>mailbox_sync_state</widget>
        </row>
        <row>
          <widget>mailbox_lastSyncUpdate</widget>
        </row>
        <row>
          <widget>mailbox_origin</widget>
        </row>
        <row>
          <widget>mailbox_sync_id</widget>
        </row>
      </rows>
    </layout>

    <layout name="cm_mailbox_managers">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <widget>mailbox_users</widget>
        </row>
        <row>
          <widget>mailbox_groups</widget>
        </row>
      </rows>
    </layout>

    <layout name="cm_participants">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <widget>action_participants</widget>
        </row>
        <row>
          <widget>copy_participants</widget>
        </row>
        <row>
          <widget>distribution_comment</widget>
        </row>
      </rows>
    </layout>

    <layout name="head_cm_document">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <widget>senders</widget>
        </row>
        <row>
          <widget>document_date</widget>
        </row>
        <row>
          <widget>receive_date</widget>
        </row>
        <row>
          <widget>sending_date</widget>
        </row>
        <row>
          <widget>initial_action_internal_participant_mailboxes</widget>
        </row>
        <row>
          <widget>initial_copy_internal_participant_mailboxes</widget>
        </row>
        <row>
          <widget>initial_action_external_participant_mailboxes</widget>
        </row>
        <row>
          <widget>initial_copy_external_participant_mailboxes</widget>
        </row>
        <row>
          <widget>reference</widget>
        </row>
      </rows>
      <widget name="senders" type="list">
        <labels>
          <label mode="any">label.casemanagement.document.senders
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdoc:senders</field>
        </fields>
        <subWidgets>
          <widget name="sender" type="text">
            <labels>
              <label mode="any"></label>
            </labels>
            <fields>
              <field></field>
            </fields>
            <properties mode="edit">
              <property name="styleClass">dataInputText</property>
            </properties>
          </widget>
        </subWidgets>
      </widget>
      <widget name="document_date" type="datetime">
        <labels>
          <label mode="any">label.casemanagement.document.document_date
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdoc:document_date</field>
        </fields>
        <properties widgetMode="view">
          <property name="pattern">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
        <properties widgetMode="edit">
          <property name="format">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
      </widget>
      <widget name="receive_date" type="datetime">
        <labels>
          <label mode="any">label.casemanagement.document.receive_date
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdoc:receive_date</field>
        </fields>
        <properties widgetMode="view">
          <property name="pattern">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
        <properties widgetMode="edit">
          <property name="format">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
      </widget>
      <widget name="sending_date" type="datetime">
        <labels>
          <label mode="any">label.casemanagement.document.sending_date
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdoc:sending_date</field>
        </fields>
        <properties widgetMode="view">
          <property name="pattern">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
        <properties widgetMode="edit">
          <property name="format">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
      </widget>
      <widget name="initial_action_internal_participant_mailboxes"
        type="list">
        <labels>
          <label mode="any">
            label.casemanagement.document.initial.participant.internal.action
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdist:initial_action_internal_participant_mailboxes
          </field>
        </fields>
        <subWidgets>
          <widget type="text">
            <labels>
              <label mode="any"></label>
            </labels>
            <fields>
              <field></field>
            </fields>
            <properties mode="edit">
              <property name="styleClass">dataInputText</property>
            </properties>
          </widget>
        </subWidgets>
      </widget>
      <widget name="initial_copy_internal_participant_mailboxes"
        type="list">
        <labels>
          <label mode="any">
            label.casemanagement.document.initial.participant.internal.information
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdist:initial_copy_internal_participant_mailboxes
          </field>
        </fields>
        <subWidgets>
          <widget type="text">
            <labels>
              <label mode="any"></label>
            </labels>
            <fields>
              <field></field>
            </fields>
            <properties mode="edit">
              <property name="styleClass">dataInputText</property>
            </properties>
          </widget>
        </subWidgets>
      </widget>
      <widget name="initial_action_external_participant_mailboxes"
        type="list">
        <labels>
          <label mode="any">
            label.casemanagement.document.initial.participant.external.action
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdist:initial_action_external_participant_mailboxes
          </field>
        </fields>
        <subWidgets>
          <widget type="text">
            <labels>
              <label mode="any"></label>
            </labels>
            <fields>
              <field></field>
            </fields>
            <properties mode="edit">
              <property name="styleClass">dataInputText</property>
            </properties>
          </widget>
        </subWidgets>
      </widget>
      <widget name="initial_copy_external_participant_mailboxes"
        type="list">
        <labels>
          <label mode="any">
            label.casemanagement.document.initial.participant.external.information
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdist:initial_copy_external_participant_mailboxes
          </field>
        </fields>
        <subWidgets>
          <widget type="text">
            <labels>
              <label mode="any"></label>
            </labels>
            <fields>
              <field></field>
            </fields>
            <properties mode="edit">
              <property name="styleClass">dataInputText</property>
            </properties>
          </widget>
        </subWidgets>
      </widget>
      <widget name="reference" type="text">
        <labels>
          <label mode="any">label.casemanagement.document.reference
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdoc:reference</field>
        </fields>
        <properties widgetMode="edit">
          <property name="styleClass">dataInputText</property>
        </properties>
      </widget>
    </layout>

    <layout name="cm_case">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <widget>title</widget>
        </row>
        <row>
          <widget>description</widget>
        </row>
      </rows>
     </layout> 
    
    <layout name="cm_document">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <widget>title</widget>
        </row>
        <row>
          <widget>document_type</widget>
        </row>
        <row>
          <widget>contactsParticipants</widget>
        </row>
        <row>
          <widget>document_date</widget>
        </row>
        <row>
          <widget>receive_date</widget>
        </row>
        <row>
          <widget>contactsSenders</widget>
        </row>
        <row>
          <widget>confidentiality</widget>
        </row>
        <row>
          <widget>origin</widget>
        </row>
        <row>
          <widget>reference</widget>
        </row>
        <row>
          <widget>body</widget>
        </row>
      </rows>
      <widget name="title" type="text">
        <labels>
          <label mode="any">title</label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>dc:title</field>
        </fields>
        <properties widgetMode="edit">
          <property name="required">true</property>
          <property name="styleClass">dataInputText</property>
        </properties>
      </widget>
      <widget name="document_type" type="selectOneDirectory">
        <fields>
          <field>cmdoc:type</field>
        </fields>
        <labels>
          <label mode="any">label.casemanagement.document.type</label>
        </labels>
        <translated>true</translated>
        <properties widgetMode="any">
          <property name="directoryName">cm_document_type</property>
          <property name="localize">true</property>
        </properties>
        <properties widgetMode="edit">
          <property name="notDisplayDefaultOption">true</property>
          <property name="ordering">label</property>
          <property name="required">true</property>
        </properties>
      </widget>

      <widget name="contactsParticipants" type="template">
        <labels>
          <label mode="any">
            label.casemanagement.document.contactsParticipants
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmct:participantsContacts</field>
        </fields>
        <properties mode="any">
          <property name="template">/casemanagement_widgets/contacts_template.xhtml
          </property>
        </properties>
        <subWidgets>
          <widget name="sender" type="text">
            <labels>
              <label mode="any">label.casemanagement.document.name
              </label>
            </labels>
            <fields>
              <field>name</field>
            </fields>
          </widget>
          <widget name="sender" type="text">
            <labels>
              <label mode="any">label.casemanagement.document.surname
              </label>
            </labels>
            <fields>
              <field>surname</field>
            </fields>
          </widget>
          <widget name="sender" type="text">
            <labels>
              <label mode="any">label.casemanagement.document.service
              </label>
            </labels>
            <fields>
              <field>service</field>
            </fields>
          </widget>
        </subWidgets>
      </widget>
      <widget name="document_date" type="datetime">
        <labels>
          <label mode="any">label.casemanagement.document.document_date
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdoc:document_date</field>
        </fields>
        <properties widgetMode="view">
          <property name="pattern">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
        <properties widgetMode="edit">
          <property name="format">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
      </widget>
      <widget name="receive_date" type="datetime">
        <labels>
          <label mode="any">label.casemanagement.document.receive_date
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdoc:receive_date</field>
        </fields>
        <properties widgetMode="view">
          <property name="pattern">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
        <properties widgetMode="edit">
          <property name="format">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
      </widget>
      <widget name="contactsSenders" type="template">
        <labels>
          <label mode="any">
            label.casemanagement.document.contactsSenders
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmct:sendersContacts</field>
        </fields>
        <properties mode="any">
          <property name="template">/casemanagement_widgets/contacts_template.xhtml
          </property>
        </properties>
        <subWidgets>
          <widget name="sender" type="text">
            <labels>
              <label mode="any">label.casemanagement.document.name
              </label>
            </labels>
            <fields>
              <field>name</field>
            </fields>
          </widget>
          <widget name="sender" type="text">
            <labels>
              <label mode="any">label.casemanagement.document.surname
              </label>
            </labels>
            <fields>
              <field>surname</field>
            </fields>
          </widget>
          <widget name="sender" type="text">
            <labels>
              <label mode="any">label.casemanagement.document.service
              </label>
            </labels>
            <fields>
              <field>service</field>
            </fields>
          </widget>
        </subWidgets>
      </widget>
      <widget name="confidentiality" type="selectOneDirectory">
        <fields>
          <field>cmdoc:confidentiality</field>
        </fields>
        <labels>
          <label mode="any">
            label.casemanagement.document.confidentiality
          </label>
        </labels>
        <translated>true</translated>
        <properties widgetMode="any">
          <!-- TODO: restrict values according to current user accreditation -->
          <property name="directoryName">
            cm_confidentiality
          </property>
          <property name="localize">true</property>
        </properties>
        <properties widgetMode="edit">
          <property name="notDisplayDefaultOption">true</property>
          <property name="ordering">label</property>
          <property name="required">true</property>
        </properties>
      </widget>
      <widget name="origin" type="text">
        <labels>
          <label mode="any">label.casemanagement.document.origin</label>
        </labels>
        <translated>true</translated>
        <fields>
          list
          <field>cmdoc:origin</field>
        </fields>
        <properties widgetMode="edit">
          <property name="styleClass">dataInputText</property>
        </properties>
      </widget>
      <widget name="reference" type="text">
        <labels>
          <label mode="any">label.casemanagement.document.reference
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdoc:reference</field>
        </fields>
        <properties widgetMode="edit">
          <property name="styleClass">dataInputText</property>
        </properties>
      </widget>
      <widget name="body" type="htmltext">
        <labels>
          <label mode="any">label.casemanagement.document.body</label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdoc:body</field>
        </fields>
      </widget>
    </layout>

    <layout name="edit_cm_document">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <widget>title</widget>
        </row>
        <row>
          <widget>document_date</widget>
        </row>
        <row>
          <widget>contactsSenders</widget>
        </row>
        <row>
          <widget>contactsRecipients</widget>
        </row>
        <row>
          <widget>document_type</widget>
        </row>
        <row>
          <widget>confidentiality</widget>
        </row>
      </rows>
      <widget name="title" type="text">
        <labels>
          <label mode="any">title</label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>dc:title</field>
        </fields>
        <properties widgetMode="edit">
          <property name="required">true</property>
          <property name="styleClass">dataInputText</property>
        </properties>
      </widget>
      <widget name="document_date" type="datetime">
        <labels>
          <label mode="any">label.casemanagement.document.document_date
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdoc:document_date</field>
        </fields>
        <properties widgetMode="view">
          <property name="pattern">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
        <properties widgetMode="edit">
          <property name="format">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
      </widget>
      <widget name="contactsSenders" type="template">
        <labels>
          <label mode="any">
            label.casemanagement.document.contactsSenders
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmct:sendersContacts</field>
        </fields>
        <properties mode="any">
          <property name="template">/casemanagement_widgets/contacts_template.xhtml
          </property>
        </properties>
        <subWidgets>
          <widget name="sender" type="text">
            <labels>
              <label mode="any">label.casemanagement.document.name
              </label>
            </labels>
            <fields>
              <field>name</field>
            </fields>
          </widget>
          <widget name="sender" type="text">
            <labels>
              <label mode="any">label.casemanagement.document.surname
              </label>
            </labels>
            <fields>
              <field>surname</field>
            </fields>
          </widget>
          <widget name="sender" type="text">
            <labels>
              <label mode="any">label.casemanagement.document.service
              </label>
            </labels>
            <fields>
              <field>service</field>
            </fields>
          </widget>
        </subWidgets>
      </widget>
      <widget name="document_type" type="selectOneDirectory">
        <fields>
          <field>cmdoc:type</field>
        </fields>
        <labels>
          <label mode="any">label.casemanagement.document.type</label>
        </labels>
        <translated>true</translated>
        <properties widgetMode="any">
          <property name="directoryName">cm_document_type</property>
          <property name="localize">true</property>
        </properties>
        <properties widgetMode="edit">
          <property name="notDisplayDefaultOption">true</property>
          <property name="ordering">label</property>
          <property name="required">true</property>
        </properties>
      </widget>
      <widget name="confidentiality" type="selectOneDirectory">
        <fields>
          <field>cmdoc:confidentiality</field>
        </fields>
        <labels>
          <label mode="any">
            label.casemanagement.document.confidentiality
          </label>
        </labels>
        <translated>true</translated>
        <properties widgetMode="any">
          <!-- TODO: restrict values according to current user accreditation -->
          <property name="directoryName">
            cm_confidentiality
          </property>
          <property name="localize">true</property>
        </properties>
        <properties widgetMode="edit">
          <property name="notDisplayDefaultOption">true</property>
          <property name="ordering">label</property>
          <property name="required">true</property>
        </properties>
      </widget>
      <widget name="contactsRecipients" type="template">
        <labels>
          <label mode="any">
            label.casemanagement.document.contactsParticipants
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmct:participantsContacts</field>
        </fields>
        <properties mode="any">
          <property name="template">/casemanagement_widgets/contacts_template.xhtml
          </property>
        </properties>
        <subWidgets>
          <widget name="sender" type="text">
            <labels>
              <label mode="any">label.casemanagement.document.name
              </label>
            </labels>
            <fields>
              <field>name</field>
            </fields>
          </widget>
          <widget name="sender" type="text">
            <labels>
              <label mode="any">label.casemanagement.document.surname
              </label>
            </labels>
            <fields>
              <field>surname</field>
            </fields>
          </widget>
          <widget name="sender" type="text">
            <labels>
              <label mode="any">label.casemanagement.document.service
              </label>
            </labels>
            <fields>
              <field>service</field>
            </fields>
          </widget>
        </subWidgets>
      </widget>
    </layout>

    <layout name="distribution_caselink">

      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>

      <rows>
        <row>
          <widget>initial_action_external_participant_mailboxes</widget>
        </row>
        <row>
          <widget>initial_copy_external_participant_mailboxes</widget>
        </row>
        <row>
          <widget>initial_action_internal_participant_mailboxes</widget>
        </row>
        <row>
          <widget>initial_copy_internal_participant_mailboxes</widget>
        </row>
        <row>
          <widget>comment</widget>
        </row>
      </rows>


      <widget name="initial_action_external_participant_mailboxes"
        type="list">
        <labels>
          <label mode="any">
            label.casemanagement.document.initial.participant.external.action
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdist:initial_action_external_participant_mailboxes
          </field>
        </fields>
        <subWidgets>
          <widget name="sender" type="text">
            <labels>
              <label mode="any"></label>
            </labels>
            <fields>
              <field></field>
            </fields>
            <properties mode="edit">
              <property name="styleClass">dataInputText</property>
            </properties>
          </widget>
        </subWidgets>
      </widget>

      <widget name="initial_copy_external_participant_mailboxes"
        type="list">
        <labels>
          <label mode="any">
            label.casemanagement.document.initial.participant.external.information
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>cmdist:initial_copy_external_participant_mailboxes
          </field>
        </fields>
        <subWidgets>
          <widget name="sender" type="text">
            <labels>
              <label mode="any"></label>
            </labels>
            <fields>
              <field></field>
            </fields>
            <properties mode="edit">
              <property name="styleClass">dataInputText</property>
            </properties>
          </widget>
        </subWidgets>
      </widget>

      <widget name="initial_action_internal_participant_mailboxes"
        type="template">
        <fields>
          <field>cmdist:initial_action_internal_participant_mailboxes
          </field>
        </fields>
        <labels>
          <label mode="any">
            label.casemanagement.document.initial.participant.internal.action
          </label>
        </labels>
        <translated>true</translated>
        <properties mode="any">
          <property name="template">
            /casemanagement_widgets/participants_suggestion_widget_template.xhtml
          </property>
        </properties>
        <properties widgetMode="edit">
          <property name="userSuggestionSearchType">USER_TYPE</property>
        </properties>
      </widget>

      <widget name="initial_copy_internal_participant_mailboxes"
        type="template">
        <fields>
          <field>cmdist:initial_copy_internal_participant_mailboxes
          </field>
        </fields>
        <labels>
          <label mode="any">
            label.casemanagement.document.initial.participant.internal.information
          </label>
        </labels>
        <translated>true</translated>
        <properties mode="any">
          <property name="template">
            /casemanagement_widgets/participants_suggestion_widget_template.xhtml
          </property>
        </properties>
        <properties widgetMode="edit">
          <property name="userSuggestionSearchType">USER_TYPE</property>
        </properties>
      </widget>

      <widget name="comment" type="textarea">
        <fields>
          <field>cslk:comment</field>
        </fields>
        <labels>
          <label mode="any">label.relation.comment</label>
        </labels>
        <translated>true</translated>
        <properties widgetMode="edit">
          <property name="cssStyleClass">dataInputText</property>
        </properties>
      </widget>

    </layout>

    <layout name="cm_relation_search">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <widget>predicate</widget>
        </row>
        <row>
          <widget>targetDocuments</widget>
        </row>
        <row>
          <widget>comment</widget>
        </row>
      </rows>
      <widget name="predicate" type="selectOneDirectory">
        <fields>
          <field>predicateUri</field>
        </fields>
        <labels>
          <label mode="any">label.cm.relations.predicateUri</label>
        </labels>
        <translated>true</translated>
        <properties widgetMode="any">
          <property name="directoryName">predicates</property>
          <property name="localize">true</property>
        </properties>
        <properties widgetMode="edit">
          <property name="required">true</property>
        </properties>
      </widget>
      <widget name="targetDocuments" type="template">
        <fields>
          <field>targetCreationDocuments</field>
        </fields>
        <labels>
          <label mode="any">
            label.cm.relations.targetDocuments
          </label>
        </labels>
        <translated>true</translated>
        <properties mode="any">
          <property name="required">true</property>
          <property name="template">
            /casemanagement_widgets/document_suggestion_widget_template.xhtml
          </property>
        </properties>
      </widget>
      <widget name="comment" type="textarea">
        <fields>
          <field>comment</field>
        </fields>
        <labels>
          <label mode="any">label.relation.comment</label>
        </labels>
        <translated>true</translated>
        <properties widgetMode="edit">
          <property name="cssStyleClass">dataInputText</property>
        </properties>
      </widget>
    </layout>

    <layout name="summary_current_case_layout">
      <templates>
        <template mode="any">/layouts/layout_summary_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <widget>summary_current_case</widget>
        </row>
        <row>
          <widget>summary_case_item_content</widget>
          <widget>summary_current_document_tagging</widget>
          <widget>summary_document_route_action</widget>
        </row>
      </rows>
    </layout>

    <layout name="routing_task">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <widget>type</widget>
        </row>
        <row>
          <widget>dueDate</widget>
        </row>
        <row>
          <widget>automaticValidation</widget>
        </row>
      </rows>
      <widget name="type" type="selectOneDirectory">
        <fields>
          <field>rtsk:type</field>
        </fields>
        <labels>
          <label mode="any">label.casemanagement.routing.task.type
          </label>
        </labels>
        <translated>true</translated>
        <properties widgetMode="any">
          <property name="directoryName">cm_routing_task_type</property>
          <property name="localize">true</property>
        </properties>
        <properties widgetMode="edit">
          <property name="notDisplayDefaultOption">true</property>
          <property name="ordering">label</property>
          <property name="required">true</property>
        </properties>
      </widget>
      <widget name="dueDate" type="datetime">
        <labels>
          <label mode="any">label.casemanagement.routing.task.dueDate
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>rtsk:dueDate</field>
        </fields>
        <properties widgetMode="view">
          <property name="pattern">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
        <properties widgetMode="edit">
          <property name="format">#{nxu:basicDateAndTimeFormater()}
          </property>
        </properties>
      </widget>
      <widget name="automaticValidation" type="checkbox">
        <translated>true</translated>
        <labels>
          <label mode="any">label.casemanagement.routing.task.automaticValidation
          </label>
        </labels>
        <fields>
          <field>rtsk:automaticValidation</field>
        </fields>
      </widget>
      <widget name="actionnable" type="checkbox">
        <translated>true</translated>
        <labels>
          <label mode="any">label.casemanagement.routing.task.actionnable
          </label>
        </labels>
        <fields>
          <field>rtsk:actionnable</field>
        </fields>
      </widget>
    </layout>

    <layout name="generic_mailboxes_routing_task">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <widget>distribution_mailbox</widget>
        </row>
      </rows>
      <widget name="distribution_mailbox" type="template">
        <labels>
          <label mode="any">label.casemanagement.routing.task.mailboxId
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>rtsk:distributionMailboxId</field>
        </fields>
        <properties mode="any">
          <property name="template">
            /casemanagement_widgets/single_mailbox_suggestion_widget_template.xhtml
          </property>
          <property name="mailboxSuggestionSearchType">generic</property>
        </properties>
      </widget>
    </layout>

    <layout name="personal_mailboxes_routing_task">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <widget>distribution_mailbox</widget>
        </row>
      </rows>
      <widget name="distribution_mailbox" type="template">
        <labels>
          <label mode="any">label.casemanagement.routing.task.mailboxId
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>rtsk:distributionMailboxId</field>
        </fields>
        <properties mode="any">
          <property name="template">
            /casemanagement_widgets/single_mailbox_suggestion_widget_template.xhtml
          </property>
          <property name="mailboxSuggestionSearchType">personal</property>
        </properties>
      </widget>
    </layout>

    <layout name="all_mailboxes_routing_task">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <widget>distribution_mailbox</widget>
        </row>
      </rows>
      <widget name="distribution_mailbox" type="template">
        <labels>
          <label mode="any">label.casemanagement.routing.task.mailboxId
          </label>
        </labels>
        <translated>true</translated>
        <fields>
          <field>rtsk:distributionMailboxId</field>
        </fields>
        <properties mode="any">
          <property name="template">
            /casemanagement_widgets/single_mailbox_suggestion_widget_template.xhtml
          </property>
          <property name="mailboxSuggestionSearchType"></property>
        </properties>
      </widget>
    </layout>

  </extension>
</component>
