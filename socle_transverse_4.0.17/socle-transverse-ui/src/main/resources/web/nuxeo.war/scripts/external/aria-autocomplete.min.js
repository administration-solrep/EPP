/*!
 * Aria-autocomplete v1.4.2
 * https://github.com/ecedi/aria-autocomplete
 */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var s in i)("object"==typeof exports?exports:e)[s]=i[s]}}(window,(function(){return function(e){var t={};function i(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,t,i){window,e.exports=function(e){var t={};function i(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";var s;function n(e,t){if(e)for(var i in t){var s="number"==typeof t[i]?t[i]+"px":t[i];e.style[i]=s+""}}i.r(t),i.d(t,"InputAutoWidth",(function(){return r}));var r=function(){function e(e,t){this.cache={},this.options=t,this.input=e,this.trigger(),this.eventHandler=this.trigger.bind(this),this.input.addEventListener("blur",this.eventHandler),this.input.addEventListener("input",this.eventHandler),this.input.addEventListener("keyup",this.eventHandler),this.input.addEventListener("keydown",this.eventHandler)}return e.prototype.measureString=function(e){return e?this.cache&&"number"==typeof this.cache[e]?this.cache[e]:(s||(n(s=document.createElement("span"),{position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}),document.body.appendChild(s)),s.textContent=e,function(e,t,i){if(e&&t){var s=getComputedStyle(e),r={};if(i&&i.length)for(var o=0,l=i.length;o<l;o+=1)r[i[o]]=s[i[o]];else r=s;n(t,r)}}(this.input,s,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]),s.offsetWidth||s.clientWidth):0},e.prototype.trigger=function(e){if(void 0===e&&(e={}),!e.metaKey&&!e.altKey){var t,i,s=this.input.value;if(e.type&&"keydown"===e.type.toLowerCase()){var n=e.keyCode,r=46===n,o=8===n;if(r||o){var l=function(e){var t={};if("selectionStart"in e)t.start=e.selectionStart,t.length=e.selectionEnd-t.start;else if(document.selection){e.focus();var i=document.selection.createRange(),s=i.text.length;i.moveStart("character",-e.value.length),t.start=i.text.length-s,t.length=s}return t}(this.input);l.length?s=s.substring(0,l.start)+s.substring(l.start+l.length):o&&l.start?s=s.substring(0,l.start-1)+s.substring(l.start+1):r&&void 0!==l.start&&(s=s.substring(0,l.start)+s.substring(l.start+1))}else if((t=n)>=48&&t<=57||t>=65&&t<=90||t>=96&&t<=111||t>=186&&t<=222||32===t||8===t||46===t){var a=String.fromCharCode(n);s+=a=e.shiftKey?a.toUpperCase():a.toLowerCase()}}!s&&(i=this.input.getAttribute("placeholder"))&&(s=i);var h=this.measureString(s)+4;this.options&&this.options.cache&&this.cache&&(this.cache[s]=h);var u=this.options&&this.options.minWidth;"number"==typeof u&&h<u&&(h=u);var c=this.options&&this.options.maxWidth;"number"==typeof c&&h>c&&(h=c),h!==this.currentWidth&&(this.currentWidth=h,this.input.style.width=h+"px")}},e.prototype.destroy=function(){this.input.removeEventListener("blur",this.eventHandler),this.input.removeEventListener("input",this.eventHandler),this.input.removeEventListener("keyup",this.eventHandler),this.input.removeEventListener("keydown",this.eventHandler),this.input=this.cache=null},e}();t.default=r}])},function(e,t){var i=Element.prototype;i.matches||(i.matches=i.msMatchesSelector||i.webkitMatchesSelector),i.closest||(i.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null})},function(e,t,i){"use strict";i.r(t),i.d(t,"AriaAutocomplete",(function(){return B}));var s=i(0),n=i.n(s),r=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function o(e,t){if(e&&1===e.nodeType&&"string"==typeof t)!function(e,t){for(var i=e.getAttribute&&e.getAttribute("class")||"",s=" "+i+" ",n=0,o=t.split(" "),l=o.length;n<l;n+=1)s=s.replace(" "+o[n]+" "," ");var a;i!==(s=null==(a=s)?"":(a+"").replace(r,""))&&e.setAttribute("class",s)}(e,t);else if(e&&"number"==typeof e.length)for(var i=0,s=e.length;i<s;i+=1)o(e[i],t)}var l=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function a(e,t){if(e&&1===e.nodeType&&"string"==typeof t)!function(e,t){for(var i=e.getAttribute&&e.getAttribute("class")||"",s=" "+i+" ",n="",r=0,o=t.split(" "),a=o.length;r<a;r+=1)""!==o[r]&&-1===s.indexOf(" "+o[r]+" ")&&(n+=" "+o[r]);var h;i!==(n=null==(h=i+n)?"":(h+"").replace(l,""))&&e.setAttribute("class",n)}(e,t);else if(e&&"number"==typeof e.length)for(var i=0,s=e.length;i<s;i+=1)a(e[i],t)}var h=function(e){for(var t in void 0===e&&(e={}),this.sourceMapping={},this.alsoSearchIn=[],this.delay=100,this.keepUserInput=!1,this.minLength=1,this.maxResults=9999,this.showAllControl=!1,this.deleteAllControl=!1,this.confirmOnBlur=!0,this.multiple=!1,this.autoGrow=!1,this.maxItems=9999,this.multipleSeparator=",",this.deleteOnBackspace=!1,this.asyncQueryParam="q",this.asyncMaxResultsParam="limit",this.noResultsText="No results",this.cssNameSpace="aria-autocomplete",this.srDeleteText="delete",this.srDeletedText="deleted",this.srShowAllText="Show all",this.srDeleteAllText="Delete all",this.srSelectedText="selected",this.srListLabelText="Search suggestions",this.srAssistiveText="When results are available use up and down arrows to review and enter to select. Touch device users, explore by touch or with swipe gestures.",this.srResultsText=function(e){return e+" "+(1===e?"result":"results")+" available."},e)e.hasOwnProperty(t)&&void 0!==e[t]&&(this[t]=e[t])},u="_ariaAutocompleteCleanedLabel",c="_ariaAutocompleteSelectedOption",p=8,d=13,f=27,m=32,v=35,b=36,g=38,y=40,A=46,S=function(){function e(e){this.list=e.list,this.input=e.input,this.wrapper=e.wrapper,this.options=e.options,this.selected=e.selected,this.open=this.open.bind(e),this.close=this.close.bind(e),this.enable=this.enable.bind(e),this.disable=this.disable.bind(e),this.filter=this.filter.bind(e),this.destroy=this.destroy.bind(e),e.element.ariaAutocomplete=this}return e.prototype.open=function(){this.show.call(this)},e.prototype.close=function(){this.hide.call(this)},e.prototype.enable=function(){this.enable.call(this)},e.prototype.disable=function(){this.disable.call(this)},e.prototype.filter=function(e){this.filter.call(this,e)},e.prototype.destroy=function(){this.destroy.call(this)},e}(),E=0,w=function(e,t){E+=1,this.ELEMENT=e;var i=t||e||"";this.PREFIX=i+"aria-autocomplete-"+E,this.LABEL=this.PREFIX+"-label",this.LIST=this.PREFIX+"-list",this.BUTTON=this.PREFIX+"-button",this.DELETE=this.PREFIX+"-delete",this.OPTION=this.PREFIX+"-option",this.WRAPPER=this.PREFIX+"-wrapper",this.INPUT=t||this.PREFIX+"-input",this.SR_ASSISTANCE=this.PREFIX+"-sr-assistance",this.OPTION_SELECTED=this.PREFIX+"-option-selected",this.SR_ANNOUNCEMENTS=this.PREFIX+"-sr-announcements"};i(1);function T(e){return null==e?"":(e+"").trim()}var x=/&/g,O=/\s\s+/g,I=/[\u2018\u2019',:\u2013-]/g,_=/[\-\[\]{}()*+?.,\\\^$|#\s]/g;function L(e,t){return void 0===t&&(t=!1),e=T(e).toLowerCase().replace(I,"").replace(x,"and").replace(O," "),t&&(e=e.replace(_,"\\$&")),e}function C(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i={};return e.forEach((function(e){for(var t in e)e.hasOwnProperty(t)&&void 0!==e[t]&&(i[t]=e[t])})),i}function N(e,t){if("createEvent"in document){var i=document.createEvent("HTMLEvents");i.initEvent(t,!0,!0),e.dispatchEvent(i)}else e.fireEvent("on"+t)}function P(e){return e&&e.children?Array.prototype.slice.call(e.children):[]}function k(e,t,i){t=!!t,e&&("INPUT"===e.nodeName&&"checked"in e&&e.checked!==t&&(e.checked=t,N(e,"change")),"OPTION"===e.nodeName&&"selected"in e&&e.selected!==t&&(e.selected=t,clearTimeout(i.elementChangeEventTimer),i.elementChangeEventTimer=setTimeout((function(){N(e.closest("select"),"change")}),1)))}function F(e,t,i){void 0===t&&(t={}),void 0===i&&(i=!0);var s=[],n=t.value,r=t.label;return e.forEach((function(e){var t={};"string"==typeof e?t.value=t.label=e:((t=C(e)).value=(t[n]||t.value||t.label||"").toString(),t.label=(t[r]||t.label||t.value||"").toString()),!1!==i&&(t[u]=L(t.label)),s.push(t)})),s}function D(e,t,i){if("string"==typeof e)return function(e,t,i){return i!==u&&(e=L(e,!1)),-1!==e.search(t)}(e,t,i);if(Array.isArray(e))for(var s=0,n=e.length;s<n;s+=1)if(D(e[s],t))return!0;return!1}var R=function(){function e(e,t){e&&this.init(e,t)}return e.prototype.triggerOptionCallback=function(e,t,i){if(void 0===t&&(t=[]),void 0===i&&(i=this.api),"function"==typeof this.options[e])return this.options[e].apply(i,t)},e.prototype.show=function(e){if(e)return o(e,this.cssNameSpace+"--hide hide hidden"),e.removeAttribute("aria-hidden"),void e.removeAttribute("hidden");if(this.input.setAttribute("aria-expanded","true"),this.showAll){var t=(!!this.forceShowAll).toString();this.showAll.setAttribute("aria-expanded",t)}this.menuOpen||(this.show(this.list),this.menuOpen=!0,this.triggerOptionCallback("onOpen",[this.list]),this.documentClickBound||(this.documentClickBound=!0,document.addEventListener("click",this.documentClick)))},e.prototype.hide=function(e){if(e)return a(e,this.cssNameSpace+"--hide hide hidden"),e.setAttribute("aria-hidden","true"),void e.setAttribute("hidden","hidden");this.currentSelectedIndex=-1,this.input.setAttribute("aria-expanded","false"),this.showAll&&this.showAll.setAttribute("aria-expanded","false"),this.menuOpen&&(this.hide(this.list),this.menuOpen=!1,this.triggerOptionCallback("onClose",[this.list]))},e.prototype.enable=function(){if(this.disabled){this.disabled=!1,this.input.disabled=!1;var e=this.cssNameSpace;o(this.input,e+"__input--disabled disabled"),o(this.wrapper,e+"__wrapper--disabled disabled"),this.showAll&&(this.showAll.setAttribute("tabindex","0"),o(this.showAll,e+"__show-all--disabled disabled"))}this.enableDeletions()},e.prototype.disable=function(e){if(void 0===e&&(e=!1),!this.disabled){this.disabled=!0,this.input.disabled=!0;var t=this.cssNameSpace;a(this.input,t+"__input--disabled disabled"),a(this.wrapper,t+"__wrapper--disabled disabled"),this.showAll&&(this.showAll.setAttribute("tabindex","-1"),a(this.showAll,t+"__show-all--disabled disabled"))}e&&this.disableDeletions()},e.prototype.enableDeletions=function(){var e=this;this.deletionsDisabled&&(this.deletionsDisabled=!1,o(this.wrapper,this.cssNameSpace+"__wrapper--deletions-disabled"),this.getSelectedElems().forEach((function(t){o(t,e.cssNameSpace+"__selected--disabled"),t.setAttribute("tabindex","0")})))},e.prototype.disableDeletions=function(){var e=this;this.deletionsDisabled||(this.deletionsDisabled=!0,a(this.wrapper,this.cssNameSpace+"__wrapper--deletions-disabled"),this.getSelectedElems().forEach((function(t){a(t,e.cssNameSpace+"__selected--disabled"),t.setAttribute("tabindex","-1")})))},e.prototype.triggerAutoGrow=function(){this.autoGrow&&this.inputAutoWidth&&"function"==typeof this.inputAutoWidth.trigger&&this.inputAutoWidth.trigger()},e.prototype.setInputValue=function(e,t){void 0===t&&(t=!1),this.input.value=this.term=e,t&&(this.inputPollingValue=e),this.triggerAutoGrow()},e.prototype.indexOfValueIn=function(e,t,i){if(void 0===t&&(t=this.input.value),void 0===i&&(i="label"),e.length&&(t=T(t).toLowerCase()))for(var s=0,n=e.length;s<n;s+=1)if(T(e[s][i]).toLowerCase()===t)return s;return-1},e.prototype.announce=function(e,t){var i=this;if(void 0===t&&(t=400),this.srAnnouncements&&e&&"string"==typeof e){if(0===t)return this.srAnnouncements.textContent=e,void this.emptyAnnouncement();clearTimeout(this.announcementTimer),this.announcementTimer=setTimeout((function(){i.srAnnouncements.textContent=e,i.emptyAnnouncement()}),t)}},e.prototype.emptyAnnouncement=function(e){var t=this;void 0===e&&(e=2e3),this.srAnnouncements&&(0!==e?(clearTimeout(this.announcementEmptyTimer),this.announcementEmptyTimer=setTimeout((function(){t.srAnnouncements.textContent=""}),e)):this.srAnnouncements.textContent="")},e.prototype.isSelectedElem=function(e){var t=e&&e[c];return this.multiple&&"object"==typeof t},e.prototype.getSelectedElems=function(){for(var e=[],t=0,i=this.wrapper.childNodes.length;t<i;t+=1){var s=this.wrapper.childNodes[t];1===s.nodeType&&this.isSelectedElem(s)&&e.push(s)}return e},e.prototype.deleteAllSelected=function(){if(!this.deletionsDisabled){for(var e=this.selected.length;e--;){var t=C(this.selected[e]);k(t.element,!1,this),this.triggerOptionCallback("onDelete",[t])}this.selected.splice(0),this.setSourceElementValues(),this.buildMultiSelected(),this.triggerAutoGrow(),this.announce(this.options.srDeletedText,0),this.input.focus()}},e.prototype.removeEntryFromSelected=function(e){if(!this.deletionsDisabled){var t=this.selected.indexOf(e);if(-1===t)for(var i=0,s=this.selected.length;i<s;i+=1)if(this.selected[i].value===e.value){t=i;break}if(t>-1&&this.selected[t]){var n=C(this.selected[t]),r=n.label;k(n.element,!1,this),this.selected.splice(t,1),this.triggerOptionCallback("onDelete",[n]),this.setSourceElementValues(),this.buildMultiSelected(),this.triggerAutoGrow(),this.announce(r+" "+this.options.srDeletedText,0),this.input.focus()}}},e.prototype.createSelectedElemFrom=function(e){var t=e.label,i=document.createElement("span");return i.setAttribute("aria-label",this.options.srDeleteText+" "+t),i.setAttribute("class",this.cssNameSpace+"__selected"),i.setAttribute("role","button"),i.setAttribute("tabindex","0"),i.setAttribute("aria-describedby",""+this.ids.LABEL),i[c]=e,i.textContent=t,i},e.prototype.buildMultiSelected=function(){var e=this;if(this.multiple){this.multiple&&this.selected.length>=this.options.maxItems?this.disable():this.enable();var t=this.options,i=this.cssNameSpace,s=this.getSelectedElems();if(this.selected.length||s.length){var n=[];s.forEach((function(t){for(var i=t[c],s=0,r=e.selected.length;s<r;s+=1){var o=e.selected[s];if(o===i||o.value===i.value)return void n.push(t)}e.wrapper.removeChild(t)}));var r=document.createDocumentFragment();this.selected.forEach((function(t){for(var i=0,s=n.length;i<s;i+=1){var o=n[i][c];if(o===t||o.value===t.value)return}r.appendChild(e.createSelectedElemFrom(t))})),r.childNodes&&r.childNodes.length&&this.wrapper.insertBefore(r,this.srAssistance);var o=this.getSelectedElems(),l=o.map((function(t,i){var s=e.ids.OPTION_SELECTED+"-"+i;return t.setAttribute("id",s),s}));if(l.push(this.ids.LIST),this.input.setAttribute("aria-owns",l.join(" ")),this.autoGrow&&this.selected.length?this.input.removeAttribute("placeholder"):this.options.placeholder&&this.input.setAttribute("placeholder",this.options.placeholder),this.selected.length<=1)this.deleteAll&&(this.deleteAll.parentNode.removeChild(this.deleteAll),this.deleteAll=null);else if(this.options.deleteAllControl&&!this.deleteAll&&o[0]){var a=document.createElement("span");a.setAttribute("role","button"),a.setAttribute("class",i+"__delete-all"),a.setAttribute("tabindex","0"),a.setAttribute("id",""+this.ids.DELETE),a.setAttribute("aria-describedby",""+this.ids.LABEL),a.innerHTML='<span class="sr-only '+i+'__sr-only">'+t.srDeleteAllText+"</span>",o[0].parentNode.insertBefore(a,o[0]),this.deleteAll=document.getElementById(this.ids.DELETE)}}}},e.prototype.setInputDescription=function(){var e=T(this.input.getAttribute("aria-describedby"))+" "+this.ids.SR_ASSISTANCE;this.input.setAttribute("aria-describedby",e)},e.prototype.resetOptionAttributes=function(e){void 0===e&&(e=P(this.list));var t=this.cssNameSpace+"__option--focused focused focus";e.forEach((function(e){e.setAttribute("aria-selected","false"),o(e,t)}))},e.prototype.setOptionFocus=function(e,t){var i=P(this.list);if(this.resetOptionAttributes(i),t<0||!i.length)return this.currentSelectedIndex=-1,void(e&&e.target!==this.input&&this.input.focus());if(t>=i.length)return this.currentSelectedIndex=i.length-1,void this.setOptionFocus(e,this.currentSelectedIndex);var s=i[t];if(s&&"string"==typeof s.getAttribute("tabindex"))return this.currentSelectedIndex=t,a(s,this.cssNameSpace+"__option--focused focused focus"),s.setAttribute("aria-selected","true"),void s.focus();this.currentSelectedIndex=-1},e.prototype.setSourceElementValues=function(){for(var e=[],t=0,i=this.selected.length;t<i;t+=1){var s=this.selected[t];e.push(s.value),k(s.element,!0,this)}if(this.elementIsInput){var n=e.join(this.options.multipleSeparator);n!==this.element.value&&(this.element.value=n,N(this.element,"change"))}!this.selected.length&&this.elementIsSelect&&(this.element.value=""),this.triggerOptionCallback("onChange",[this.selected])},e.prototype.handleOptionSelect=function(e,t,i){if(void 0===i&&(i=!0),!("number"!=typeof t||t<0||this.multiple&&this.selected.length>=this.options.maxItems)&&this.filteredSource.length&&this.filteredSource[t]){for(var s=C(this.filteredSource[t]),n=!1,r=0,o=this.selected.length;r<o;r+=1)if(this.selected[r].value===s.value){n=!0;break}n||this.multiple||this.selected.splice(0),n||(this.selected.push(s),this.setSourceElementValues(),this.buildMultiSelected()),this.setInputValue(this.multiple?"":s.label,!0),this.triggerOptionCallback("onConfirm",[s]),this.announce(s.label+" "+this.options.srSelectedText,0),this.disabled||!1===i||this.input.focus(),this.hide()}},e.prototype.removeSelectedFromResults=function(e){var t=this;if(!this.multiple||!this.selected.length)return e;var i=[];return e.forEach((function(e){for(var s=t.selected,n=0,r=s.length;n<r;n+=1)if(e.label===s[n].label&&e.value===s[n].value)return;i.push(e)})),i},e.prototype.setListOptions=function(e){var t=[],i=this.options.sourceMapping,s=this.removeSelectedFromResults(e),n=this.triggerOptionCallback("onResponse",s);this.filteredSource=n?F(n,i):s;for(var r,l=this.ids.OPTION,h=this.cssNameSpace,u=h+"__option",c=this.filteredSource.length,p="function"==typeof this.options.onItemRender,d=this.forceShowAll?9999:this.options.maxResults,f=d<c?d:c,m=0;m<f;m+=1){var v=this.filteredSource[m],b=p&&this.triggerOptionCallback("onItemRender",[v])||v.label;t.push('<li tabindex="-1" aria-selected="false" role="option" class="'+u+'" id="'+l+"--"+m+'" aria-posinset="'+(m+1)+'" aria-setsize="'+f+'">'+b+"</li>")}t.length?(a(this.list,h+"__list--has-results"),o(this.list,h+"__list--no-results")):(o(this.list,h+"__list--has-results"),a(this.list,h+"__list--no-results"));var g=this.options.noResultsText;!t.length&&"string"==typeof g&&g.length&&(r=g,t.push('<li class="'+u+" "+u+'--no-results">'+g+"</li>")),this.cancelFilterPrep(),r||(r=this.triggerOptionCallback("srResultsText",[f])),this.announce(r);var y=t.join("");if(this.currentListHtml!==y?(this.currentListHtml=y,this.list.innerHTML=y):this.resetOptionAttributes(),!t.length)return this.hide(),void(this.forceShowAll=!1);this.show(),this.forceShowAll=!1},e.prototype.handleAsync=function(e,t){var i=this;void 0===t&&(t=!1),this.xhr&&"function"==typeof this.xhr.abort&&this.xhr.abort();var s=new XMLHttpRequest,n=this.forceShowAll,r=t?null:this.api,o=this.multiple?this.selected.length:0,l=n||t||9999===this.options.maxResults,a=this.source+(/\?/.test(this.source)?"&":"?")+encodeURIComponent(this.options.asyncQueryParam)+"="+encodeURIComponent(e)+"&"+encodeURIComponent(this.options.asyncMaxResultsParam)+"="+(l?9999:o+this.options.maxResults);a=this.triggerOptionCallback("onAsyncPrep",[a],r)||a,s.open("GET",a),s.onload=function(){if(s.readyState===s.DONE&&s.status>=200&&s.status<300){i.forceShowAll=n;var o=F(i.triggerOptionCallback("onAsyncSuccess",[e,s],r)||s.responseText,i.options.sourceMapping,!1);t?(i.prepSelectedFromArray(o),i.setInputStartingStates(!1)):i.setListOptions(o)}},s.onerror=function(){i.triggerOptionCallback("onAsyncError",[e,s],r)},t||(this.xhr=s),this.triggerOptionCallback("onAsyncBeforeSend",[s],r),s.send()},e.prototype.filter=function(e){var t=this;if("string"==typeof e){var i=this.forceShowAll;if(!i){var s=this.triggerOptionCallback("onSearch",[e]);"string"==typeof s&&(e=s)}if(this.term=e,"string"==typeof this.source&&this.source.length)return this.handleAsync(e),void(this.forceShowAll=!1);if("function"!=typeof this.source){e||(i=!0);var n=[];if(this.source&&this.source.length){var r=[u];if(!i){e=L(e,!0);var o=this.options.alsoSearchIn;Array.isArray(o)&&o.length&&(r=function(e){var t=[];return e.forEach((function(e){if("string"==typeof e){for(var i=T(e),s="label"!==i,n=0,r=t.length;s&&n<r;n+=1)s=t[r]!==i;s&&t.push(i)}})),t}(r.concat(o)))}this.source.forEach((function(t){(i||function(e,t,i){for(var s in e)if(e.hasOwnProperty(s)){var n=e[s];if(("string"==typeof n||Array.isArray(n))&&i.indexOf(s)>-1&&D(n,t,s))return!0}return!1}(t,e,r))&&n.push(t)}))}this.setListOptions(n)}else{var l=function(e){var i=F(e,t.options.sourceMapping);t.setListOptions(i)},a=this.source.call(this.api,this.term,l);a&&"function"==typeof a.then&&a.then((function(e){return l(e)}))}}else this.cancelFilterPrep()},e.prototype.cancelFilterPrep=function(){clearTimeout(this.filterTimer),o(this.wrapper,this.cssNameSpace+"__wrapper--loading loading"),o(this.input,this.cssNameSpace+"__input--loading loading"),this.filtering=!1},e.prototype.filterPrep=function(e,t,i){var s=this;void 0===t&&(t=!1),void 0===i&&(i=!1);var n=this.forceShowAll,r=n||i?0:this.options.delay;this.cancelFilterPrep(),this.filtering=!0,this.filterTimer=setTimeout((function(){var i=s.input.value;if(s.inputPollingValue=i,(n||""===i||t&&!s.multiple&&s.selected.length&&T(s.selected[0].label)===T(i))&&(i=""),!n&&i.length<s.options.minLength)s.hide();else{var r;try{var o=e;r=e&&"keydown"===e.type&&(o.altKey||o.ctrlKey||o.metaKey)}catch(e){}var l=""!==i&&i===s.term;!l||l&&!s.menuOpen&&!r?(a(s.wrapper,s.cssNameSpace+"__wrapper--loading loading"),a(s.input,s.cssNameSpace+"__input--loading loading"),s.currentSelectedIndex=-1,s.filter(i)):s.cancelFilterPrep()}}),r)},e.prototype.filterPrepShowAll=function(e){var t=this;this.disabled||(clearTimeout(this.showAllPrepTimer),this.showAllPrepTimer=setTimeout((function(){t.componentBlurTimer&&clearTimeout(t.componentBlurTimer),e.preventDefault(),t.forceShowAll=!0,t.filterPrep(e,!1,!0)}),0))},e.prototype.handleComponentBlur=function(e,t){var i=this;void 0===t&&(t=!1),clearTimeout(this.componentBlurTimer);var s=t?0:100;this.componentBlurTimer=setTimeout((function(){var e=document.activeElement;if(t||!e||i.deleteAll&&i.deleteAll===e||i.isSelectedElem(e)||!i.wrapper.contains(e)){if(i.xhr&&"function"==typeof i.xhr.abort&&i.xhr.abort(),!t&&i.options.confirmOnBlur&&i.menuOpen){var s=i.currentSelectedIndex;"number"==typeof s&&-1!==s||(s=i.indexOfValueIn.call(i,i.filteredSource)),i.handleOptionSelect({},s,!1)}if(i.cancelFilterPrep(),i.hide(),!i.multiple&&-1===i.indexOfValueIn.call(i,i.selected)){i.selected.length&&i.removeEntryFromSelected(i.selected[0]);var n=i.elementIsInput||i.elementIsSelect,r=i.element;i.options.keepUserInput?i.elementIsInput&&""!==i.input.value&&(r.value=i.input.value,N(r,"change")):(n&&""!==r.value&&(r.value="",N(r,"change")),i.setInputValue("",!0))}i.multiple&&i.setInputValue("",!0),i.documentClickBound&&(i.documentClickBound=!1,document.removeEventListener("click",i.documentClick)),i.triggerOptionCallback("onBlur",[i.wrapper]),i.isFocused=!1}}),s)},e.prototype.handleUpKey=function(e){e.preventDefault(),!this.disabled&&this.menuOpen&&"number"==typeof this.currentSelectedIndex&&this.setOptionFocus(e,this.currentSelectedIndex-1)},e.prototype.handleDownKey=function(e){if(e.preventDefault(),this.menuOpen||(this.forceShowAll=this.options.minLength<1,(this.forceShowAll||this.input.value.length>=this.options.minLength)&&this.filterPrep(e)),this.menuOpen&&!this.filtering){var t=this.currentSelectedIndex;"number"!=typeof t||t<0?this.setOptionFocus(e,0):this.setOptionFocus(e,t+1)}},e.prototype.handleEndKey=function(e){if(!this.disabled&&this.menuOpen&&e.target!==this.input){var t=P(this.list);t.length&&(e.preventDefault(),this.setOptionFocus(e,t.length-1))}},e.prototype.handleHomeKey=function(e){!this.disabled&&this.menuOpen&&e.target!==this.input&&(e.preventDefault(),this.setOptionFocus(e,0))},e.prototype.handleEnterKey=function(e){var t=e.target;this.isSelectedElem(t)?this.removeEntryFromSelected(t[c]):this.deleteAll&&t===this.deleteAll?this.deleteAllSelected():this.disabled||(this.showAll&&t===this.showAll?this.filterPrepShowAll(e):(this.menuOpen&&(e.preventDefault(),this.currentSelectedIndex>-1&&this.handleOptionSelect(e,this.currentSelectedIndex)),t===this.input&&this.filterPrep(e,!1,!0)))},e.prototype.handleKeyDownDefault=function(e){var t=e.keyCode,i=e.target===this.input;if(t===m&&!i||this.isSelectedElem(e.target)&&t===A)return e.preventDefault(),void this.handleEnterKey(e);if(!this.disabled){var s=this.selected&&this.selected.length;if(this.options.deleteOnBackspace&&t===p&&""===this.input.value&&s&&i&&this.multiple)this.removeEntryFromSelected(this.selected[s-1]);else{var n=function(e){return e>=48&&e<=57||e>=65&&e<=90||e>=96&&e<=111||e>=186&&e<=222||32===e||8===e||46===e}(t),r=!i&&n;r&&this.input.focus(),(r||i&&n)&&this.filterPrep(e)}}},e.prototype.prepKeyDown=function(e){switch(e.keyCode){case g:this.handleUpKey(e);break;case y:this.handleDownKey(e);break;case v:this.handleEndKey(e);break;case b:this.handleHomeKey(e);break;case d:this.handleEnterKey(e);break;case f:this.handleComponentBlur(e,!0);break;default:this.handleKeyDownDefault(e)}},e.prototype.cancelPolling=function(){clearTimeout(this.pollingTimer)},e.prototype.startPolling=function(){var e=this;this.filtering||this.input.value===this.inputPollingValue||this.filterPrep({}),this.pollingTimer=setTimeout((function(){e.startPolling()}),200)},e.prototype.bindEvents=function(){var e=this;this.wrapper.addEventListener("focusout",(function(t){e.handleComponentBlur(t,!1)})),this.wrapper.addEventListener("focusin",(function(t){e.list.contains(t.target)||(e.currentSelectedIndex=-1),e.isFocused||e.triggerOptionCallback("onFocus",[e.wrapper]),e.isFocused=!0})),this.wrapper.addEventListener("keydown",(function(t){e.prepKeyDown(t)})),this.wrapper.addEventListener("click",(function(t){t.target!==e.wrapper?!e.deleteAll||t.target!==e.deleteAll&&!e.deleteAll.contains(t.target)?e.isSelectedElem(t.target)&&e.removeEntryFromSelected(t.target[c]):e.deleteAllSelected():e.input.focus()}));var t=this.cssNameSpace+"__wrapper--focused focused focus",i=this.cssNameSpace+"__input--focused focused focus";this.input.addEventListener("blur",(function(){o(e.wrapper,t),o(e.input,i),e.cancelPolling()})),this.input.addEventListener("input",(function(t){document.activeElement===e.input&&e.filterPrep(t)})),this.input.addEventListener("click",(function(t){!e.menuOpen&&e.input.value.length>=e.options.minLength&&e.filterPrep(t,!0)})),this.input.addEventListener("focusin",(function(s){a(e.wrapper,t),a(e.input,i),e.startPolling(),e.disabled||e.menuOpen||e.filterPrep(s,!0)})),this.showAll&&this.showAll.addEventListener("click",(function(t){e.filterPrepShowAll(t)})),this.list.addEventListener("mouseenter",(function(t){e.resetOptionAttributes()})),this.list.addEventListener("click",(function(t){var i=t.target;if(i!==e.list){var s=P(e.list);if(s.length){var n=i.closest('[role="option"]'),r=s.indexOf(n);e.handleOptionSelect(t,r)}}})),this.autoGrow&&(this.inputAutoWidth=new n.a(this.input))},e.prototype.prepListSourceCheckboxes=function(){this.multiple=!0,this.source=[];for(var e=this.element.querySelectorAll('input[type="checkbox"]'),t=0,i=e.length;t<i;t+=1){var s=e[t];if(s.value){var n={element:s,value:s.value},r=s.closest("label");!r&&s.id&&(r=document.querySelector('[for="'+s.id+'"]')),r&&(n.label=r.textContent),n.label||(n.label=n.value),n[u]=L(n.label),this.source.push(n),s.checked&&this.selected.push(n)}}},e.prototype.prepListSourceDdl=function(){var e=this.element.multiple;e&&!this.multiple&&(this.multiple=!0),!e&&this.multiple&&this.options.maxItems>1&&(this.options.maxItems=1),this.source=[];for(var t=this.element.querySelectorAll("option"),i=0,s=t.length;i<s;i+=1){var n=t[i];if(n.value){var r={element:n,value:n.value,label:n.textContent};r[u]=L(r.label),this.source.push(r),n.selected&&this.selected.push(r)}}},e.prototype.prepSelectedFromArray=function(e){var t=this,i=this.elementIsInput&&this.element.value;if(i&&e&&e.length){var s=this.options.multiple,n=this.options.multipleSeparator;(s?i.split(n):[i]).forEach((function(i){if(-1===t.indexOfValueIn(t.selected,i,"value")){var s=t.indexOfValueIn(e,i,"value");s>-1&&t.selected.push(e[s])}}))}},e.prototype.prepListSourceArray=function(){this.source=F(this.source,this.options.sourceMapping),this.prepSelectedFromArray(this.source)},e.prototype.prepListSourceAsync=function(){var e=this.element;this.elementIsInput&&e.value&&this.handleAsync(e.value,!0)},e.prototype.prepListSourceFunction=function(){var e=this,t=this.element;if(this.elementIsInput&&t.value){var i=function(t){var i=F(t,e.options.sourceMapping);e.prepSelectedFromArray(i),e.setInputStartingStates(!1)},s=this.source.call(void 0,t.value,i);s&&"function"==typeof s.then&&s.then((function(e){return i(e)}))}},e.prototype.prepListSource=function(){return"function"==typeof this.source?this.prepListSourceFunction():"string"==typeof this.source&&this.source.length?this.prepListSourceAsync():Array.isArray(this.source)&&this.source.length?this.prepListSourceArray():this.elementIsSelect?this.prepListSourceDdl():void(this.element.querySelector('input[type="checkbox"]')&&this.prepListSourceCheckboxes())},e.prototype.setInputStartingStates=function(e){if(void 0===e&&(e=!0),e){var t=this.element.getAttribute("aria-describedby");t&&this.input.setAttribute("aria-describedby",t);var i=this.element.getAttribute("aria-labelledby");i&&this.input.setAttribute("aria-labelledby",i)}this.selected.length&&(this.multiple?(this.buildMultiSelected(),this.triggerAutoGrow()):this.setInputValue(this.selected[0].label||"",!0)),this.setInputDescription(),this.element.disabled&&this.disable(!0)},e.prototype.setHtml=function(){var e=this.options,t=this.cssNameSpace,i=e.wrapperClassName?" "+e.wrapperClassName:"",s=['<div id="'+this.ids.WRAPPER+'" class="'+t+"__wrapper"+i+'">'],n=e.name?' name="'+e.name+'"':"",r=e.inputClassName?" "+e.inputClassName:"",o=e.placeholder?' placeholder="'+e.placeholder+'" aria-placeholder="'+e.placeholder+'"':"";if(s.push('<input type="text" autocomplete="off" aria-expanded="false" aria-autocomplete="list" role="combobox" id="'+this.ids.INPUT+'" aria-owns="'+this.ids.LIST+'" class="'+t+"__input"+r+'"'+n+o+" />"),this.ids.ELEMENT){var l=document.querySelector('[for="'+this.ids.ELEMENT+'"]');l&&(l._ariaAutocompleteLabelOriginallyFor=this.ids.ELEMENT,l._ariaAutocompleteLabelOriginallyId=l.getAttribute("id"),l.setAttribute("for",this.ids.INPUT),l.setAttribute("id",this.ids.LABEL),this.elementHasLabel=!0)}e.showAllControl&&s.push('<span role="button" aria-label="'+e.srShowAllText+'" class="'+t+'__show-all" tabindex="0" id="'+this.ids.BUTTON+'" aria-describedby="'+this.ids.LABEL+'" aria-expanded="false"></span>');var a=e.srListLabelText,h=e.listClassName?" "+e.listClassName:"",u=a?' aria-label="'+a+'"':"",c=this.elementHasLabel?' aria-describedby="'+this.ids.LABEL+'"':"";s.push('<ul id="'+this.ids.LIST+'" class="'+t+"__list"+h+'" role="listbox" aria-hidden="true" hidden="hidden"'+u+" "+c+"></ul>"),s.push('<p class="hide hidden '+t+"--hide "+t+'__sr-assistance" id="'+this.ids.SR_ASSISTANCE+'">'+e.srAssistiveText+"</p>"),s.push('<p class="sr-only '+t+"__sr-only "+t+'__sr-announcements" id="'+this.ids.SR_ANNOUNCEMENTS+'" aria-live="polite" aria-atomic="true"></p>'),s.push("</div>"),this.element.insertAdjacentHTML("afterend",s.join(""))},e.prototype.destroy=function(){var e=this,t=document.querySelector('[for="'+this.ids.INPUT+'"]');t&&t._ariaAutocompleteLabelOriginallyFor&&(t.setAttribute("for",t._ariaAutocompleteLabelOriginallyFor),delete t._ariaAutocompleteLabelOriginallyFor,t._ariaAutocompleteLabelOriginallyId&&(t.setAttribute("id",t._ariaAutocompleteLabelOriginallyId),delete t._ariaAutocompleteLabelOriginallyId)),this.documentClickBound&&document.removeEventListener("click",this.documentClick),this.autoGrow&&this.inputAutoWidth&&this.inputAutoWidth.destroy(),this.element.parentNode.removeChild(this.wrapper),delete this.element.ariaAutocomplete,this.show(this.element),clearTimeout(this.filterTimer),clearTimeout(this.pollingTimer),clearTimeout(this.showAllPrepTimer),clearTimeout(this.announcementTimer),clearTimeout(this.componentBlurTimer),clearTimeout(this.elementChangeEventTimer),["element","list","input","wrapper","showAll","deleteAll","srAssistance","srAnnouncements"].forEach((function(t){return e[t]=null}))},e.prototype.init=function(e,t){this.selected=[],this.element=e,this.ids=new w(e.id,t.id),this.elementIsInput="INPUT"===e.nodeName,this.elementIsSelect="SELECT"===e.nodeName,this.options=new h(t),this.source=this.options.source,this.multiple=this.options.multiple,this.autoGrow=this.options.autoGrow,this.cssNameSpace=this.options.cssNameSpace,this.documentClick=this.handleComponentBlur.bind(this),this.setHtml(),this.list=document.getElementById(this.ids.LIST),this.input=document.getElementById(this.ids.INPUT),this.wrapper=document.getElementById(this.ids.WRAPPER),this.showAll=document.getElementById(this.ids.BUTTON),this.srAssistance=document.getElementById(this.ids.SR_ASSISTANCE),this.srAnnouncements=document.getElementById(this.ids.SR_ANNOUNCEMENTS),this.prepListSource();var i=[];this.options.showAllControl&&i.push(this.cssNameSpace+"__wrapper--show-all"),this.options.deleteAllControl&&i.push(this.cssNameSpace+"__wrapper--delete-all"),this.autoGrow&&i.push(this.cssNameSpace+"__wrapper--autogrow"),this.multiple&&i.push(this.cssNameSpace+"__wrapper--multiple"),i.length&&a(this.wrapper,i.join(" ")),this.hide(this.list),this.hide(this.element),this.setInputStartingStates(),this.bindEvents(),this.api=new S(this),this.triggerOptionCallback("onReady",[this.wrapper])},e}();function B(e,t){return e&&e.ariaAutocomplete&&e.ariaAutocomplete.open?e.ariaAutocomplete:new R(e,t).api}t.default=B}])}));